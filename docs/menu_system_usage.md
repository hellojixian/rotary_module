# 菜单系统使用说明

## 界面布局

### 状态栏（顶部）
```
[相机状态]                    [电池电压]
----------------------------------------
```
- **左上角**：显示相机连接状态
  - `No Camera` - 相机未连接
  - `Cable` - 连接线已插入但未检测到相机
  - `Camera OK` - 相机正常连接
- **右上角**：显示电池电压（如：4.2V）

**注意**：在配置模式和配置编辑模式下，状态栏会自动隐藏以提供更多显示空间。

### 主显示区域
根据当前模式显示不同内容。

### 界面优化特性
- **智能状态栏**：在需要更多空间的配置界面中自动隐藏
- **全屏配置**：配置和编辑界面使用全屏显示，提供更好的用户体验
- **清晰布局**：每个配置项单独显示，避免信息过载

## 操作模式

### 1. 待机模式
**显示内容：**
```
[No Camera]                    [4.2V]
----------------------------------------
        Rotary Platform
```

**操作：**
- 系统会自动根据相机状态切换到相应模式
- 长按 CANCEL 键 1秒进入配置模式

### 2. 相机模式（相机连接时）
**显示内容：**
```
[Camera OK]                    [4.2V]
----------------------------------------
     Press OK to Start
       Photo Mode
```

**操作：**
- 短按 OK 键：启动拍照模式
- 长按 CANCEL 键 1秒：进入配置模式

### 3. 3D扫描模式（相机未连接时）
**显示内容：**
```
[No Camera]                    [4.2V]
----------------------------------------
     Press OK to Start
      3D Scan Mode
```

**操作：**
- 短按 OK 键：启动3D扫描模式
- 长按 CANCEL 键 1秒：进入配置模式

### 4. 配置模式
**显示内容：**（全屏显示，隐藏状态栏以提供更多空间）
```
      Configuration

> Motor Dir
  CW
```

**特点：**
- 隐藏顶部状态栏，提供更多显示空间
- 每次只显示一个配置项，布局清晰
- 居中显示标题

**操作：**
- PREV/NEXT 键：切换配置项
- OK 键：进入编辑模式
- CANCEL 键：返回主菜单

**配置项列表：**
1. **Motor Dir** - 电机方向（CW/CCW）
2. **Motor Speed** - 电机速度（2ms-8ms）
3. **Rotation** - 旋转角度（90°/180°/360°/540°/720°）
4. **Photo Int** - 拍照间隔（5°/10°/15°/30°）

### 5. 配置编辑模式
**显示内容：**（全屏显示）
```
       Edit Setting

Item: Motor Dir
Value: CW
```

**特点：**
- 全屏显示，更清晰的编辑界面
- 明确显示正在编辑的项目和当前值

**操作：**
- PREV/NEXT 键：调整数值
- OK 键：保存并返回配置模式
- CANCEL 键：取消并返回配置模式

### 6. 拍照运行模式
**显示内容：**
```
[Camera OK]                    [4.2V]
----------------------------------------
Photo: 3/10
[####      ]
```

**流程：**
1. 3秒倒计时（每秒beep）
2. 自动对焦
3. 拍摄第一张照片
4. 旋转电机到下一个角度
5. 重复拍照直到完成
6. 播放完成提示音

**操作：**
- CANCEL 或 OK 键：停止拍照并返回菜单

### 7. 3D扫描运行模式
**显示内容：**
```
[No Camera]                    [4.2V]
----------------------------------------
Scan: 2.5 turns
Time: 01:23
```

**流程：**
1. 3秒倒计时（每秒beep）
2. 开始连续旋转
3. 实时显示旋转圈数和运行时间

**操作：**
- CANCEL 或 OK 键：停止扫描并返回菜单

## 按键功能总结

| 按键 | 短按功能 | 长按功能 |
|------|----------|----------|
| CANCEL | 返回/取消 | 进入配置模式（在主菜单时） |
| PREV | 上一项/减少数值 | - |
| NEXT | 下一项/增加数值 | - |
| OK | 确认/启动 | - |

## 音频提示

- **启动音**：系统启动时播放上升音阶
- **按键音**：不同按键有不同频率的提示音
- **倒计时音**：每秒1500Hz提示音
- **完成音**：拍照完成时播放双音提示
- **错误音**：操作错误时播放1000Hz提示音

## 配置存储

所有配置参数自动保存到EEPROM中，断电后不会丢失。首次使用或配置损坏时会自动恢复默认值。

## 故障排除

1. **电压显示异常**：检查电压传感器连接（PC2引脚）
2. **相机状态错误**：检查相机连接线和触发引脚
3. **按键无响应**：检查按键硬件连接
4. **电机不转动**：检查步进电机驱动器连接
